// content/writing/article.11tydata.js

// This file defines data specific to the article-template.njk.
// It will be merged with data from other sources (like _data/composeArticle.js
// and the global writing.11tydata.js) based on Eleventy's data cascade.

export default {
  // Pagination configuration for creating multiple pages from 'composeArticle'
  pagination: {
    data: "composeArticle", // The global data source from _data/composeArticle.js
    size: 1, // Generate one page per item from the 'composeArticle' array
    alias: "post" // 'post' will be the variable name for each item in the article-template.njk
  },

  // The layout to be used for these dynamically generated article pages
  layout: "layouts/article.njk",

  // Tags to apply to all pages generated by article-template.njk
  tags: [
    "writing"
  ],

  // eleventyComputed for dynamic permalinks and titles for each article
  eleventyComputed: {
    permalink: function(data) {
      // Access the 'post' alias from pagination data
      // This function will only run when data.post is defined (i.e., for each paginated article)
      if (data.post && data.post.fields && data.post.fields.slug) {
        // Construct the output path for individual blog posts
        return `/writing/${data.post.fields.slug}/index.html`;
      }
      // If a slug is missing, return false to prevent page creation for that specific Contentful article.
      // The `page.url is defined` check in your navigation will handle this gracefully.
      return false;
    },
    title: function(data) {
      // Access the 'post' alias from pagination data for the page title
      if (data.post && data.post.fields && data.post.fields.headline) {
        return data.post.fields.headline;
      }
      // Fallback title if headline is missing
      return "Untitled Blog Post";
    }
  }
};